#!/bin/bash
cd $(dirname $0)

# adding cron job if necessary
(crontab -l 2>/dev/null; echo "* * * * * $(pwd)/start-server") | awk '!x[$0]++' | crontab -

cd server/

touch docker-dash.pid
# checking if main is already running
ps -e | grep $(cat docker-dash.pid) 2>/dev/null | grep -v "grep" &> /dev/null
if [ $? -ne 0 ]; then 
  # starting main
  nohup .venv/bin/python main.py "$@" > /dev/null 2>&1 &
fi